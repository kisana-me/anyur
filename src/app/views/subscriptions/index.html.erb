<% content_for :title, "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³" %>

<h1>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³</h1>

<%= link_to "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®ä¸€è¦§", new_subscription_path %>

<h2>ç¾åœ¨ã®çŠ¶æ³</h2>
<% if @subscription %>
  <p>ğŸ‘‘ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ä¸­ã§ã™</p>
  <p><strong>ID:</strong> <%= @subscription.id %></p>
<% else %>
  <p>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã—ã¦ã„ã¾ã›ã‚“</p>
  <%= link_to "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹", new_subscription_path %>
<% end %>

<h2>ãŠæ”¯æ‰•ã„ã®ç®¡ç†</h2>
<% if @current_account.stripe_customer_id.present? %>
  <%= link_to "â†—ï¸ãƒãƒ¼ã‚¿ãƒ«ã§ç®¡ç†(stripe.com)", customer_portal_subscriptions_path, method: :get, target: "_blank", rel: "noopener noreferrer", data: { turbo: false } %>
<% else %>
  <p>ãŠæ”¯æ‰•ã„ã¯ä¸€åº¦ã‚‚ã‚ã‚Šã¾ã›ã‚“</p>
  <%= link_to "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹", new_subscription_path %>
<% end %>

<h2>è©³ç´°</h2>

<div class="container">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Stripe ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ID</th>
        <th>Stripe ãƒ—ãƒ©ãƒ³ID</th>
        <th>ç¾åœ¨ã®æœŸé–“é–‹å§‹æ—¥æ™‚</th>
        <th>ç¾åœ¨ã®æœŸé–“çµ‚äº†æ—¥æ™‚</th>
        <th>æœŸé–“çµ‚äº†æ™‚ã«ã‚­ãƒ£ãƒ³ã‚»ãƒ«</th>
        <th>ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ—¥æ™‚</th>
        <th>ãƒˆãƒ©ã‚¤ã‚¢ãƒ«é–‹å§‹æ—¥æ™‚</th>
        <th>ãƒˆãƒ©ã‚¤ã‚¢ãƒ«çµ‚äº†æ—¥æ™‚</th>
        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
      </tr>
    </thead>
    <tbody>
      <% @subscriptions.each do |subscription| %>
      <tr>
        <td><%= subscription.id %></td>
        <td><%= subscription.stripe_subscription_id %></td>
        <td><%= subscription.stripe_plan_id %></td>
        <td><%= subscription.current_period_start&.strftime("%Y-%m-%d %H:%M:%S") %></td>
        <td><%= subscription.current_period_end&.strftime("%Y-%m-%d %H:%M:%S") %></td>
        <td><%= subscription.cancel_at_period_end ? 'ã¯ã„' : 'ã„ã„ãˆ' %></td>
        <td><%= subscription.canceled_at&.strftime("%Y-%m-%d %H:%M:%S") %></td>
        <td><%= subscription.trial_start_at&.strftime("%Y-%m-%d %H:%M:%S") %></td>
        <td><%= subscription.trial_end_at&.strftime("%Y-%m-%d %H:%M:%S") %></td>
        <td>
          <%= t("activerecord.enums.subscription.subscription_status.#{subscription.subscription_status.downcase}") %>
      </td>
      </tr>
      <% end %>
      <% if @subscriptions.empty? %>
        <tr>
          <td colspan="10" class="no-data">ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<style>
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    background-color: #fff;
    table-layout: auto;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 12px 15px;
    text-align: left;
  }
  th {
    background-color: #007bff;
    color: #fff;
    font-weight: bold;
    white-space: nowrap;
    min-width: 150px;
  }
  td {
    white-space: nowrap;
  }
  tr:nth-child(even) {
    background-color: #f9f9f9;
  }
  tr:hover {
    background-color: #f1f1f1;
  }
  .container {
    overflow-x: auto;
  }
  .no-data {
    text-align: left;
    padding: 20px;
    font-style: italic;
  }
</style>